<!DOCTYPE html>
<html>
<head>
    <title>ãƒ—ãƒ­ã‚­ã‚·ãƒ‡ãƒãƒƒã‚°</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        .test-btn { padding: 10px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>ğŸ”§ ãƒ—ãƒ­ã‚­ã‚·ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«</h1>
    
    <div>
        <button class="test-btn" onclick="testHealth()">1. ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
        <button class="test-btn" onclick="testDirect()">2. ç›´æ¥æ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
        <button class="test-btn" onclick="testProxy()">3. ãƒ—ãƒ­ã‚­ã‚·æ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
        <button class="test-btn" onclick="testEncryption()">4. æš—å·åŒ–ãƒ†ã‚¹ãƒˆ</button>
    </div>
    
    <div id="results" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>

    <script>
        const SERVER = 'https://proxy-server-ckjw.onrender.com';
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            document.getElementById('results').appendChild(div);
        }
        
        async function testHealth() {
            log('ã‚µãƒ¼ãƒãƒ¼ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯...');
            try {
                const response = await fetch(SERVER + '/health');
                const data = await response.json();
                log(`âœ… ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šæˆåŠŸ: ${data.status}`, 'success');
                log(`ãƒãƒ¼ã‚¸ãƒ§ãƒ³: ${data.version}`, 'info');
                log(`èµ·å‹•æ™‚é–“: ${Math.floor(data.uptime)}ç§’`, 'info');
            } catch(error) {
                log(`âŒ ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šå¤±æ•—: ${error.message}`, 'error');
            }
        }
        
        async function testDirect() {
            log('ç›´æ¥æ¥ç¶šãƒ†ã‚¹ãƒˆ (Google)...');
            try {
                const response = await fetch('https://www.google.com');
                log(`âœ… ç›´æ¥æ¥ç¶šæˆåŠŸ: ${response.status}`, 'success');
            } catch(error) {
                log(`âŒ ç›´æ¥æ¥ç¶šå¤±æ•—: ${error.message}`, 'error');
            }
        }
        
        async function testProxy() {
            log('ãƒ—ãƒ­ã‚­ã‚·æ¥ç¶šãƒ†ã‚¹ãƒˆ (GoogleçµŒç”±)...');
            try {
                const response = await fetch(SERVER + '/');
                const text = await response.text();
                log(`âœ… ãƒ—ãƒ­ã‚­ã‚·æ¥ç¶šæˆåŠŸ: ${response.status}`, 'success');
                log(`ã‚¿ã‚¤ãƒˆãƒ«: ${text.match(/<title>(.*?)<\/title>/)?.[1] || 'ä¸æ˜'}`, 'info');
            } catch(error) {
                log(`âŒ ãƒ—ãƒ­ã‚­ã‚·æ¥ç¶šå¤±æ•—: ${error.message}`, 'error');
            }
        }
        
        function testEncryption() {
            log('æš—å·åŒ–ãƒ†ã‚¹ãƒˆ...');
            const testUrl = 'https://www.google.com';
            
            // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´æš—å·åŒ–
            const secretKey = 'y-redhat-testserver-2024';
            let encrypted = btoa(testUrl);
            encrypted = encrypted.split('').reverse().join('');
            
            let shifted = '';
            for (let i = 0; i < encrypted.length; i++) {
                const charCode = encrypted.charCodeAt(i);
                const shift = secretKey.charCodeAt(i % secretKey.length) % 10;
                shifted += String.fromCharCode(charCode + shift);
            }
            
            const finalEncrypted = btoa(shifted);
            log(`å…ƒã®URL: ${testUrl}`, 'info');
            log(`æš—å·åŒ–å¾Œ: ${finalEncrypted.substring(0, 50)}...`, 'info');
            log(`é•·ã•: ${finalEncrypted.length}æ–‡å­—`, 'info');
        }
        
        // è‡ªå‹•ãƒ†ã‚¹ãƒˆ
        setTimeout(testHealth, 1000);
    </script>
</body>
</html>
